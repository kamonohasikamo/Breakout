<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<title>GameCanvas</title>
		<style>
			*{padding:0; margin: 0; }
			canvas {background: #eee; display: block; margin: 0 auto; }
		</style>
	</head>
	<body>
		<canvas id="myCanvas" width="400" height="320"></canvas>
		<script>
			// canvas要素への参照
			var canvas = document.getElementById("myCanvas");
			// 2D描画コンテキストを保存する変数
			var ctx = canvas.getContext("2d");

			//=========================================
			// Ball Definition
			//=========================================
			var ball_x = canvas.width / 2;
			var ball_y = canvas.height - 30;
			var dx = 2;
			var dy = -2;
			var ballRadius = 10;
			
			//=========================================
			// Paddle Definition
			//=========================================
			var paddleHeight = 10;
			var paddleWidth = 75;
			var paddleX = (canvas.width - paddleWidth) / 2;

			//=========================================
			// Paddle Moving Definition
			//=========================================
			var isOnPressRight = false;
			var isOnPressLeft = false;

			function OnPressKey(e) {
				if (e.key == "Right" || e.key == "ArrowRight") {
					isOnPressRight = true;
				} else if (e.key == "Left" || e.key == "ArrowLeft") {
					isOnPressLeft = true;
				}
			}

			function UpKey(e) {
				if (e.key == "Right" || e.key == "ArrowRight") {
					isOnPressRight = false;
				} else if (e.key == "Left" || e.key == "ArrowLeft") {
					isOnPressLeft = false;
				}
			}

			function drawPaddle() {
				ctx.beginPath();
				ctx.rect(paddleX, canvas.height - paddleHeight, paddleWidth, paddleHeight);
				ctx.fillStyle = "#0095DD"
				ctx.fill();
				ctx.closePath();
			}
			
			function drawBall() {
				ctx.beginPath();
				ctx.arc(ball_x, ball_y, ballRadius, 0, Math.PI*2);
				ctx.fillStyle = "#0095DD";
				ctx.fill();
				ctx.closePath();
			}
			
			function draw() {
				// clear Ball Trajectory
				ctx.clearRect(0, 0, canvas.width, canvas.height);

				drawBall();
				drawPaddle();

				// 跳ね返りの判定
				if (ball_y + dy < ballRadius || ball_y + dy > canvas.height - ballRadius) {
					dy = -dy;
				}
				if (ball_x + dx < ballRadius || ball_x + dx > canvas.width - ballRadius) {
					dx = -dx
				}
				ball_x += dx;
				ball_y += dy;

				// Paddle Moving
				if (isOnPressRight && paddleX < canvas.width - paddleWidth) {
					paddleX += 7;
				} else if (isOnPressLeft && paddleX > 0) {
					paddleX -= 7;
				}

			}

			// addEventListener 
			// ボタンが押されたときに発火
			document.addEventListener("keydown", OnPressKey, false);
			// addEventListener 
			// ボタンが離れたときに発火
			document.addEventListener("keyup", UpKey, false);
			// draw関数が10msごとに実行される
			setInterval(draw, 10);
		</script>
	</body>
</html>